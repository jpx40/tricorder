<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.96.0"><title>tricorder - tricorder</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/tricorder/css/style.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.4/css/all.css integrity=sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm crossorigin=anonymous></head><body><main><nav><div class=menu><a href=/tricorder/ class=active><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M575.8 255.5c0 18-15 32.1-32 32.1H511.8L512.5 447.7C512.5 450.5 512.3 453.1 512 455.8V472c0 22.1-17.9 40-40 40H456C454.9 512 453.8 511.1 452.7 511.9 451.3 511.1 449.9 512 448.5 512H392c-22.1.0-40-17.9-40-40V384c0-17.7-14.3-32-32-32H256c-17.7.0-32 14.3-32 32v88c0 22.1-17.9 40-40 40H128.1C126.6 512 125.1 511.9 123.6 511.8 122.4 511.9 121.2 512 120 512H104c-22.09.0-40-17.9-40-40V360C64 359.1 64.03 358.1 64.09 357.2V287.6H32.05C14.02 287.6.0 273.5.0 255.5c0-9 3.004-17 10.01-24L266.4 8.016c7-7.014 15-8.016 22-8.016s15 2.004 21.1 7.014L564.8 231.5c8 7 12.1 15 11 24z"/></svg></a><a href=https://github.com/linkdd/tricorder><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8.0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8.0-21.5 4.9-32.3 14.6-51.8 45.3.0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8.0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9.0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2.0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8.0-73.5 38.7-73.5 82.6.0 87.8 80.4 101.3 150.4 101.3h48.2c70.3.0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8.0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg></a><a href=/tricorder/tutorials/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 336V48c0-26.51-21.5-48-48-48H96C42.98.0.0 42.98.0 96v320c0 53.02 42.98 96 96 96h320c17.67.0 32-14.33 32-31.1.0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144S344.8 160 336 160H143.1C135.2 160 128 152.8 128 144S135.2 128 143.1 128zm0 64h192C344.8 192 352 199.2 352 208S344.8 224 336 224H143.1C135.2 224 128 216.8 128 208S135.2 192 143.1 192zM384 448H96c-17.67.0-32-14.33-32-32s14.33-32 32-32h288v64z"/></svg></a><a href=https://docs.rs/tricorder/latest/tricorder/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M414.8 40.79 286.8 488.8C281.9 505.8 264.2 515.6 247.2 510.8 230.2 505.9 220.4 488.2 225.2 471.2l128-447.99C358.1 6.216 375.8-3.624 392.8 1.232c17 4.855 26.8 22.568 22 39.558h0zM518.6 121.4l112 112c12.5 12.5 12.5 32.7.0 45.2l-112 112c-12.5 12.5-32.7 12.5-45.2.0s-12.5-32.7.0-45.2L562.7 256 473.4 166.6c-12.5-12.5-12.5-32.7.0-45.2s32.7-12.5 45.2.0v0zm-352 45.2L77.25 256l89.35 89.4c12.5 12.5 12.5 32.7.0 45.2s-32.7 12.5-45.2.0L9.372 278.6c-12.496-12.5-12.496-32.7.0-45.2L121.4 121.4c12.5-12.5 32.7-12.5 45.2.0s12.5 32.7.0 45.2v0z"/></svg></a></div></nav><article><header>tricorder</header><h1 id=automation-the-kiss-way>Automation the KISS way</h1><div class=lcars-screen><div class=buttons><a href=/tricorder/tutorials/cli/>Command Line Interface</a>
<a href=/tricorder/tutorials/inventory/>Multiple remotes, all at once</a>
<a href=/tricorder/tutorials/setup-auth/>Connect via SSH</a>
<a href=/tricorder/tutorials/setup-auth/>Completely agent-less</a>
<a href=/tricorder/tutorials/cicd/>Integrate seamlessly in your CI/CD</a></div><div class=viewport><canvas id=lcars-canvas></canvas></div></div><div id=lcars-assets class=hidden><img id=lcars-asset-desktop src=/tricorder/img/desktop.svg>
<img id=lcars-asset-server src=/tricorder/img/server.svg>
<img id=lcars-asset-server-pending src=/tricorder/img/server-pending.svg>
<img id=lcars-asset-server-success src=/tricorder/img/server-success.svg>
<img id=lcars-asset-server-error src=/tricorder/img/server-error.svg>
<img id=lcars-asset-scanlines src=/tricorder/img/scanlines.png></div><script defer type=application/javascript>window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("lcars-canvas"),t=e.getContext("2d"),n=e=>{t.drawImage(e.img,e.rect.x,e.rect.y,e.rect.w,e.rect.h)},o=[{id:"path",offset:0,speed:.4,update:e=>{e.offset-=e.speed,e.offset<=-12&&(e.offset=0)},render:n=>{for(const s of[0,1,2,3])t.beginPath(),t.lineDashOffset=n.offset,t.setLineDash([6,6]),t.moveTo(e.width/2,e.height-32),t.lineTo(e.width/2,e.height/2),t.lineTo((s+1)*e.width/5,e.height/2),t.lineTo((s+1)*e.width/5,32),t.lineWidth=2,t.strokeStyle="rgb(239, 68, 68)",t.stroke()}},{id:"desktop",rect:{x:e.width/2-16,y:e.height-32,w:32,h:32},img:document.getElementById("lcars-asset-desktop"),render:n},...[0,1,2,3].map(t=>({id:`server${t}`,rect:{x:(t+1)*e.width/5-16,y:0,w:32,h:32},img:document.getElementById("lcars-asset-server"),state:'',doneState:Math.random()>.5?"-success":"-error",update:e=>{const o=4,i=Date.now()/4e3,n=3,a=n*(o+1),s=1/(1+Math.exp(-1*Math.tan(i)))*a;s<n*t?(e.state='',e.doneState=Math.random()>.5?"-success":"-error"):s<n*(t+1)?e.state="-pending":e.state=e.doneState,e.img=document.getElementById(`lcars-asset-server${e.state}`)},render:n}))],s=()=>{t.clearRect(0,0,e.width,e.height);for(const e of o)e.update!==void 0&&e.update(e),e.render!==void 0&&e.render(e);requestAnimationFrame(s)};requestAnimationFrame(s)})</script><h1 id=no-yaml-involved>No YAML involved</h1><h2 id=first-an-inventory>First an inventory</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[[<span style=color:#a6e22e>hosts</span>]]
</span></span><span style=display:flex><span><span style=color:#a6e22e>id</span> = <span style=color:#e6db74>&#34;backend&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>address</span> = <span style=color:#e6db74>&#34;10.0.1.10:22&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>user</span> = <span style=color:#e6db74>&#34;root&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tags</span> = [<span style=color:#e6db74>&#34;server&#34;</span>, <span style=color:#e6db74>&#34;backend&#34;</span>, <span style=color:#e6db74>&#34;myapp&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>vars</span> = { <span style=color:#a6e22e>msg</span> = <span style=color:#e6db74>&#34;hi&#34;</span> }
</span></span></code></pre></div><h2 id=then-a-command>Then a command</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ tricorder -i /path/to/inventory <span style=color:#66d9ef>do</span> -- echo <span style=color:#e6db74>&#34;{host.id} says {host.vars.msg}&#34;</span>
</span></span></code></pre></div><h2 id=finally-a-json-output>Finally, a JSON output</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;host&#34;</span>: <span style=color:#e6db74>&#34;backend&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;success&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;info&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;exit_code&#34;</span>: <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;backend says hi\n&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h1 id=rust-api>Rust API</h1><h2 id=add-dependency>Add dependency</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span><span style=color:#a6e22e>tricorder</span> = <span style=color:#e6db74>&#34;0.9&#34;</span>
</span></span></code></pre></div><h2 id=write-your-recipe>Write your recipe</h2><h3 id=first-import-symbols>First, import symbols</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>use</span> tricorder::prelude::<span style=color:#f92672>*</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> tricorder::tasks::exec;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> serde_json::json;
</span></span></code></pre></div><h3 id=then-build-your-inventory>Then, build your inventory</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> inventory <span style=color:#f92672>=</span> Inventory::new()
</span></span><span style=display:flex><span>  .add_host(
</span></span><span style=display:flex><span>    Host::new(Host::id(<span style=color:#e6db74>&#34;localhost&#34;</span>).unwrap(), <span style=color:#e6db74>&#34;localhost:22&#34;</span>.to_string())
</span></span><span style=display:flex><span>      .set_user(<span style=color:#e6db74>&#34;root&#34;</span>.to_string())
</span></span><span style=display:flex><span>      .add_tag(Host::tag(<span style=color:#e6db74>&#34;local&#34;</span>).unwrap())
</span></span><span style=display:flex><span>      .set_var(<span style=color:#e6db74>&#34;msg&#34;</span>.to_string(), json<span style=color:#f92672>!</span>(<span style=color:#e6db74>&#34;hello&#34;</span>))
</span></span><span style=display:flex><span>      .to_owned()
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>  .to_owned();
</span></span></code></pre></div><h3 id=finally-run-your-tasks>Finally, run your tasks</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> task <span style=color:#f92672>=</span> exec::Task::new(<span style=color:#e6db74>&#34;echo \&#34;{host.id} says {host.vars.msg}\&#34;&#34;</span>.to_string());
</span></span></code></pre></div><p><strong>Sequentially:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> result <span style=color:#f92672>=</span> inventory.hosts.run_task_seq(<span style=color:#f92672>&amp;</span>task).unwrap();
</span></span></code></pre></div><p><strong>Or concurrently:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> result <span style=color:#f92672>=</span> inventory.hosts.run_task_parallel(<span style=color:#f92672>&amp;</span>task).unwrap();
</span></span></code></pre></div><p>The result is a <code>serde_json::Value</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>println!(<span style=color:#e6db74>&#34;{}&#34;</span>, result);
</span></span></code></pre></div><h2 id=build-and-run>Build and run</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cargo run
</span></span></code></pre></div><h1 id=backstory>Backstory</h1><figure><img src=https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/12.5.12GeorgeTakeiByLuigiNovi10.jpg/440px-12.5.12GeorgeTakeiByLuigiNovi10.jpg><figcaption><h4>Actor George Takei autographs a tricorder</h4></figcaption></figure><p><a href=https://ansible.com>Ansible</a> is a great tool for automation. But it suffers
from the same problem of many such tools: a big pile of custom YAML DSL.</p><p>YAML is used to provide a declarative syntax of your automated workflow. This is
nice for simple use cases, but automation can become rather complex very
quickly.</p><p>Once those tools start implementing:</p><ul><li>control flow structures (conditions, loops)</li><li>variable assignations</li><li>modules</li><li>package management</li><li>&mldr;</li></ul><p>Your YAML files become a programming language with terrible developer
experience.</p><p><strong>tricorder</strong> aims to fix this. It gives you a single tool to perform tasks on
multiple remotes. You then use your common UNIX tools like <code>bash</code>, <code>jq</code>, <code>curl</code>,
etc&mldr; to compose those tasks together.</p><p>The name comes from <a href=https://en.wikipedia.org/wiki/Tricorder>Star Trek&rsquo;s Tricorder</a>,
a multifunction hand-held device to perform sensor environment scans, data
recording, and data analysis. Pretty much anything required by the plot.</p><p>The main goal of <strong>tricorder</strong> is to provide the basic tools to perform tasks on
remote hosts and get out of your way. Allowing you to integrate it with any
scripting language or programming language of your choice, instead of forcing
you to develop in a sub-par custom YAML DSL.</p><blockquote><p>Spock stared hard at his tricorder, as if by sheer will he might force it to
tell him the answer to his questions.</p></blockquote><h1 id=reading-resources>Reading resources</h1><div class=lcars-actions><a href=https://github.com/linkdd/tricorder>Source Code</a>
<a href=https://docs.rs/tricorder/latest/tricorder/>API reference</a>
<a href=/tricorder/tutorials/>Tutorials</a></div><footer>Website content is distributed under the terms of the
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC-BY-SA 4.0</a> license.</footer></article></main></body></html>